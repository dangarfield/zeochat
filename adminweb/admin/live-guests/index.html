<!DOCTYPE html>
<html class="loading" lang="en" data-textdirection="ltr">

<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
  <meta name="description" content="Stack admin is super flexible, powerful, clean &amp; modern responsive bootstrap 4 admin template with unlimited possibilities.">
  <meta name="keywords" content="admin template, stack admin template, dashboard template, flat admin template, responsive admin template, web app">
  <meta name="author" content="PIXINVENT">
  <title>Chat Application - Stack Responsive Bootstrap 4 Admin Template</title>
  <link rel="apple-touch-icon" href="/admin/assets/img/ico/apple-icon-120.png">
  <link rel="shortcut icon" type="image/x-icon" href="/admin/assets/img/ico/favicon.ico"> <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Montserrat:300,300i,400,400i,500,500i%7COpen+Sans:300,300i,400,400i,600,600i,700,700i">
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Advent+Pro:400">
<link rel="stylesheet" type="text/css" href="/admin/assets/css/vendors.css">
<link rel="stylesheet" type="text/css" href="/admin/assets/css/app.css">
<link rel="stylesheet" type="text/css" href="/admin/assets/css/vertical-overlay-menu.css">
<link rel="stylesheet" type="text/css" href="/admin/assets/css/style.css">
</head>

<body class="vertical-layout vertical-overlay-menu content-left-sidebar chat-application  menu-expanded fixed-navbar" data-open="click"
  data-menu="vertical-overlay-menu" data-col="content-left-sidebar">
  <nav class="header-navbar navbar-expand-md navbar navbar-with-menu fixed-top navbar-dark bg-primary navbar-shadow navbar-brand-center">
  <div class="navbar-wrapper">
    <div class="navbar-header">
      <ul class="nav navbar-nav flex-row">
        <li class="nav-item mobile-menu d-md-none mr-auto">
          <a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
            <i class="ft-menu font-large-1"></i>
          </a>
        </li>
        <li class="nav-item">
          <a class="navbar-brand" href="index.html">
            <img class="brand-logo" alt="stack admin logo" src="/admin/assets/img/logo/zeochat-icon-white-32.png">
            <h2 class="brand-text">zeochat</h2>
          </a>
        </li>
        <li class="nav-item d-md-none">
          <a class="nav-link open-navbar-container" data-toggle="collapse" data-target="#navbar-mobile">
            <i class="fa fa-ellipsis-v"></i>
          </a>
        </li>
      </ul>
    </div>
    <div class="navbar-container content">
      <div class="collapse navbar-collapse" id="navbar-mobile">
        <ul class="nav navbar-nav mr-auto float-left">
          <li class="nav-item d-none d-md-block">
            <a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#">
              <i class="ft-menu"></i>
            </a>
          </li>
          <li class="nav-item d-none d-md-block">
            <a class="nav-link nav-link-expand" href="#">
              <i class="ficon ft-maximize"></i>
            </a>
          </li>
        </ul>
        <ul class="nav navbar-nav float-right">
          <li class="nav-item">
            <a class="nav-link nav-link-label" href="/admin">
              <i class="ficon ft-eye"></i> Console
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-label" href="/admin/live-guests">
              <i class="ficon ft-user"></i>
              <span class="badge badge-pill badge-default badge-warning badge-up guest-count"></span> Live Guests
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-label" href="/admin/archive">
              <i class="ficon ft-package"></i> Archive
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-label" href="/admin/status">
              <i class="ficon ft-activity"></i> Status
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-label" href="/admin/interests">
              <i class="ficon ft-trending-up"></i> Interests
            </a>
          </li>
          <li class="nav-item">
            <a class="nav-link nav-link-label" href="/admin/feedback">
              <i class="ficon ft-edit"></i> Feedback
            </a>
          </li>
        </ul>
      </div>
    </div>
  </div>
</nav> <div class="main-menu menu-fixed menu-light menu-accordion menu-shadow menu-border">
  <div class="main-menu-content">
    <ul class="navigation navigation-main" id="main-menu-navigation" data-menu="menu-navigation">
      <li class=" navigation-header">
        <span>Admin</span>
        <i class="ft-minus" data-toggle="tooltip" data-placement="right" data-original-title="Apps"></i>
      </li>
      <li class="nav-item">
        <a href="/admin">
          <i class="ft-eye"></i>
          <span class="menu-title">Console</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="/admin/live-guests">
          <i class="ft-user"></i>
          <span class="menu-title">Live Guests</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="/admin/archive">
          <i class="ft-package"></i>
          <span class="menu-title">Archive</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="/admin/status">
          <i class="ft-activity"></i>
          <span class="menu-title">Status</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="/admin/interests">
          <i class="ft-trending-up"></i>
          <span class="menu-title">Interests</span>
        </a>
      </li>
      <li class="nav-item">
        <a href="/admin/feedback">
          <i class="ft-edit"></i>
          <span class="menu-title">Feedback</span>
        </a>
      </li>
    </ul>
  </div>
</div> <div class="app-content content">
    <div class="content-wrapper">
        <div class="content-header-left col-md-6 col-12 mb-2">
    <h3 class="content-header-title mb-0">Live Guests</h3>
    <div class="row breadcrumbs-top">
        <div class="breadcrumb-wrapper col-12">
            <ol class="breadcrumb">
                    <li class="breadcrumb-item">
                        <a href="/admin">Console</a>
                    </li>
                    <li class="breadcrumb-item active">Live Guests
                    </li>
            </ol>
        </div>
    </div>
</div> <script src="/admin/assets/js/vendors.min.js" type="text/javascript"></script>
<script src="/admin/assets/js/app-menu.js" type="text/javascript"></script>
<script src="/admin/assets/js/app.js" type="text/javascript"></script>
<script src="/admin/assets/js/prism.min.js" type="text/javascript"></script>
<script src="/admin/assets/js/admin-generic.js" type="text/javascript"></script> <style>
    .live-guests .col-sm-1 {
        padding-left: 5px;
        padding-right: 5px;
    }

    .live-guests .row {
        margin-left: -5px;
        margin-right: -5px;
    }

    .live-guests .card {
        margin-bottom: 10px;
    }

    .card-icon-bl {
        position: absolute;
        right: 0;
        top: 0;
        background: white;
    }

    .card-icon-br {
        position: absolute;
        right: 0;
        top: 14px;
        background: white;
    }
</style>
<div class="live-guests">
</div>
<script>
    function chunk(arr, size) {
        var arr2 = arr.slice(0),
            arrays = [];
        while (arr2.length > 0) {
            arrays.push(arr2.splice(0, size));
        }
        return arrays;
    }

    function showLiveGuests() {
        console.log('Show live guests');
        $('.live-guests').empty();

        $.getJSON("/admin/api/live-guests", function (data) {
            console.log(data);
            var items = [];
            $.each(data.guests, function (key, val) {

                var html = '';
                html = html + '<div class="col-sm-1">';
                html = html + '<div class="card">';
                html = html + '  <a href="/admin/monitor-chat/?id=' + val._id + '">';
                html = html + '    <img class="card-img-top" src="' + val.image + '" />';

                if (val.gender) {
                    if (val.gender == 'Male') {
                        html = html + '<span class="card-icon-bl text-muted fa fa-male"></span>';
                    } else {
                        html = html + '<span class="card-icon-bl text-danger fa fa-female"></span>';
                    }
                }
                if (val.nsfw) {
                    if (val.nsfw < 0.33) {
                        html = html + '<span class="card-icon-br text-muted fa fa-star-o"></span>';
                    } else if (val.nsfw < 0.66) {
                        html = html + '<span class="card-icon-br text-primary fa fa-star-half-o"></span>';
                    } else {
                        html = html + '<span class="card-icon-br text-danger fa fa-star"></span>';
                    }
                }

                html = html + '  </a>';
                html = html + '</div>';
                html = html + '</div>';

                console.log(html);
                items.push(html);
            });
            console.log(items);
            var chunked = chunk(items, 12);
            console.log(chunked);
            var html2 = '';
            $.each(chunked, function (key2, chunk) {
                html2 = html2 + '<div class="row">';
                $.each(chunk, function (key3, item) {
                    html2 = html2 + item;
                    // Temporarily adding multiple images
                    i = 200
                    while (i <= 50) {
                        html2 = html2 + item;
                        i++;
                    }
                })
                html2 = html2 + '</div>';
            })

            $('.live-guests').append(html2);
        });
    }

    if ($('.live-guests').length > 0) {
        showLiveGuests();
        //var interval = setInterval(showLiveGuests, 5000);
    }

</script>
    </div>
</div> <footer class="chat-component  footer fixed-bottom footer-light navbar-border">
  <p class="clearfix blue-grey lighten-2 text-sm-center mb-0 px-2">
    <span class="float-md-left d-block d-md-inline-block">
      Copyright &copy; 2018
      <a class="text-bold-800 grey darken-2" href="/">zeochat </a>, All rights reserved.
    </span>
  </p>
</footer>
</body>

</html>